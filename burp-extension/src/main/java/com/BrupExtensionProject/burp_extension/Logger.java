package com.BrupExtensionProject.burp_extension;

import burp.IBurpExtenderCallbacks;

public class Logger {
    private static IBurpExtenderCallbacks callbacks;

    public static void setCallbacks(IBurpExtenderCallbacks callbacks) {
        Logger.callbacks = callbacks;
    }

    private static String getClassName() {
        StackTraceElement[] stackTrace = Thread.currentThread().getStackTrace();
        if (stackTrace.length > 3) {
            return stackTrace[3].getClassName();
        }
        return "UnknownClass";
    }

    public static void log(String message) {
        String className = getClassName();
        String logMessage = "[" + className + "] " + message;
        if (callbacks != null) {
            callbacks.printOutput(logMessage);
        } else {
            System.out.println(logMessage);
        }
    }
}
